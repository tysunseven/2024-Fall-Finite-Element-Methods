---
layout: default
title: 2024-Fall-Finite-Element-Methods
---

# 2024-Fall-Finite-Element-Methods



<p><a href="https://tysunseven.github.io/2024-Fall-Finite-Element-Methods/WrittenAssignments/Week1_WrittenAssignment.pdf">第一周书面作业</a></p>

## 绪论
任务拆解
- 有限差分方法
- 变分问题
- 极小化问题


有限元方法是 50 年代首先在连续体力学领域——飞机结构静、动态特性分析中应用的一种有效的数值分析方法，广泛地应用于求解热传导、电磁场、流体力学等连续性问题。 
  
有限元方法是将两点边值问题转化为变分问题或者是极小化问题，再用有限维空间代替无穷维空间，找到变分问题或者是极小化问题的逼近解。

下面我们先来回顾一下有限差分方法. 考虑两点边值问题

$$ 
(\mathrm{P}):\begin{cases}
 -u''(x) = f(x), & 0 < x < 1, \\
u(0) = u(1) = 0, &
\end{cases} 
$$

为了使用有限差分方法求解这个问题, 我们首先将区间 $[0,1]$ 离散化. 假设将区间划分为 $n+1$ 个等距节点，步长为 $h = \frac{1}{n+1}$, 节点的坐标为 $x_i = ih$, 其中 $i = 0, 1, 2, \dots, n+1$. 记 $ u_i=u(x_i) $, 根据边界条件，$u_0 = u_{n+1} = 0$，所以我们只需要求解内部节点 $u_1, u_2, \dots, u_n$. 为此我们需要将 $ u''(x) $离散化. 对 $u(x+h)$ 和 $u(x-h)$ 进行泰勒展开：

$$
u(x+h) = u(x) + h u'(x) + \frac{h^2}{2} u''(x) + \frac{h^3}{6} u^{(3)}(x) + \frac{h^4}{24} u^{(4)}(x) + \dots
$$

$$
u(x-h) = u(x) - h u'(x) + \frac{h^2}{2} u''(x) - \frac{h^3}{6} u^{(3)}(x) + \frac{h^4}{24} u^{(4)}(x) - \dots
$$

将 $u(x+h)$ 和 $u(x-h)$ 相加：

$$
u(x+h) + u(x-h) = 2u(x) + h^2 u''(x) + \frac{h^4}{12} u^{(4)}(x) + \dots
$$

将上面的式子进行整理：

$$
u(x+h) + u(x-h) = 2u(x) + h^2 u''(x) + O(h^4)
$$

进一步，得到二阶导数的表达式：

$$
u''(x) \approx \frac{u(x+h) - 2u(x) + u(x-h)}{h^2}
$$


在离散化过程中，二阶导数 $u''(x)$ 可以通过中心差分公式近似为：

$$
u''(x_i) \approx \frac{u_{i+1} - 2u_i + u_{i-1}}{h^2}.
$$

因此，微分方程 $-u''(x) = f(x)$ 在离散化后对于每个内部节点 $x_i$ 可以表示为：

$$
-\frac{u_{i+1} - 2u_i + u_{i-1}}{h^2} = f(x_i), \quad i = 1, 2, \dots, n.
$$

整理后可以得到以下的线性代数方程：

$$
u_{i-1} - 2u_i + u_{i+1} = -h^2 f(x_i), \quad i = 1, 2, \dots, n.
$$

这组方程可以写成一个线性系统的矩阵形式：

$$
A \mathbf{u} = \mathbf{b},
$$

其中，$\mathbf{u} = [u_1, u_2, \dots, u_n]^T$ 是待求的未知向量，$\mathbf{b} = [-h^2 f(x_1), -h^2 f(x_2), \dots, -h^2 f(x_n)]^T$ 是已知的右端项向量。矩阵 $A$ 是一个 $n \times n$ 的三对角矩阵，形式为：

$$
A = \begin{pmatrix}
  -2 & 1  & 0  & \cdots & 0 \\
  1  & -2 & 1  & \cdots & 0 \\
  0  & 1  & -2 & \cdots & 0 \\
  \vdots & \vdots & \vdots & \ddots & 1 \\
  0  & 0  & 0  & 1  & -2
\end{pmatrix}.
$$

通过求解该线性系统，我们可以得到节点处的近似解 $\mathbf{u}$，进而构造出整个区间上的解的近似值. 有限差分方法虽然简单且易于实现，但也存在一些明显的缺点：

1. **几何区域的局限性**：有限差分方法通常适用于规则的几何区域，例如矩形或正方形等。对于复杂的几何区域，网格划分和离散化变得非常困难，且需要进行特殊处理，这可能会导致精度下降或者方法变得非常复杂。

2. **边界条件的处理困难**：有限差分方法对于简单的边界条件（如Dirichlet边界条件或Neumann边界条件）较为容易处理。然而，当遇到更复杂的边界条件（如Robin边界条件或不规则边界），有限差分方法的实现将变得更加复杂，可能需要特殊的技巧或近似处理，甚至影响求解的精度和稳定性。

3. **高维问题的计算复杂度**：在高维问题（例如三维的偏微分方程）中，有限差分方法需要对空间进行离散化，导致离散化点数目急剧增加。对于大规模问题，生成的线性方程组的规模很大，导致计算代价和存储需求显著增加，且矩阵的稀疏性可能不如其他数值方法（如有限元方法）处理得好。

4. **适应性较差**：有限差分方法在网格生成上较为僵硬，通常依赖于均匀的网格划分，因此对于局部特征变化较大的问题（如边界层或奇异点附近），需要全局细化网格，导致大量不必要的计算。而像有限元方法那样可以采用自适应网格来集中计算精度的局部区域，有限差分方法则较难实现。

这些缺点使得有限差分方法在处理复杂几何或边界条件时不如有限元方法和有限体积方法那样灵活。因此，有限差分方法通常适用于简单几何形状上的基本边值问题，而在处理实际工程问题或复杂边界条件时，往往需要考虑其他数值方法。

根据你上传的图片，结合两点边值问题的内容，变分问题的等价形式可以总结如下：

首先，原始的两点边值问题是：

$$
\begin{cases}
 -u''(x) = f(x), & 0 < x < 1, \\
u(0) = u(1) = 0.
\end{cases}
$$

我们通过引入弱解的思想，将其转化为变分问题。以下是等价的变分形式的步骤：

1. **测试函数空间的定义**：
   定义合适的函数空间 $ V $，通常选择满足边界条件的函数集：

   $$
   V = \{ v \in C^1([0,1]) \mid v(0) = v(1) = 0 \}.
   $$

   这是包含所有在区间 $ [0,1] $ 上连续且可微，并且在边界处 $ x = 0 $ 和 $ x = 1 $ 为零的函数的空间。

2. **弱解的定义**：
   对于每一个测试函数 $ v \in V $，将方程的二阶导数部分进行积分，通过分部积分，将二阶导数的微分方程变为一阶导数的形式。目标是消除对二阶导数的依赖。

   从原始方程 $ -u''(x) = f(x) $ 出发，对整个区间 $ [0, 1] $ 做积分：

   $$
   \int_0^1 -u''(x)v(x)\,dx = \int_0^1 f(x)v(x)\,dx.
   $$

   通过分部积分并结合边界条件 $ u(0) = u(1) = 0 $，可以将左边的项转化为：

   $$
   \int_0^1 u'(x)v'(x)\,dx = \int_0^1 f(x)v(x)\,dx.
   $$

3. **变分问题的等价形式**：
   因此，两点边值问题的弱解（即变分问题的形式）为：

   **寻找** $ u \in V $，使得对于任意的 $ v \in V $，满足以下条件：

   $$
   \int_0^1 u'(x)v'(x)\,dx = \int_0^1 f(x)v(x)\,dx.
   $$

这就是两点边值问题的等价变分形式。通过这个过程，我们将原来的二阶微分方程转化为一阶导数的积分形式，适用于弱解的概念。

结合课程板书，继续介绍极小化问题。

从变分问题的弱形式出发，我们可以进一步将其理解为一个极小化问题。具体来说，变分问题的弱解可以通过极小化某个能量泛函来得到。

假设我们定义如下的能量泛函：

$$
J(u) = \frac{1}{2} \int_0^1 |u'(x)|^2 dx - \int_0^1 f(x)u(x) dx,
$$

那么，可以证明，解变分问题的函数 $ u $ 也是极小化该能量泛函的函数。换句话说，寻找方程的解 $ u $ 相当于寻找一个使得能量泛函 $ J(u) $ 取最小值的函数。

因此，变分问题可以转化为以下的极小化问题：

**寻找** $ u \in V $ 使得：

$$
J(u) = \min_{v \in V} J(v),
$$

其中 $ V $ 是满足边界条件的函数空间。

这个极小化问题的物理意义可以理解为寻找系统的最低能量状态。在这个背景下，弱解就是使能量泛函最小的函数。这种方法在许多物理和工程问题中非常常见，尤其是在弹性力学、电磁学等领域。

通过求解极小化问题，我们可以得到与两点边值问题等价的数值解。具体的数值方法，如有限元法，通常就是基于这个极小化框架来进行离散化和求解的。也成为Ritz意义下的弱解


### 变分问题 $ (W) $ 当且仅当 极小化问题 $ (M) $

**证明：**

#### $ (W) \Rightarrow (M) $

假设 $ u $ 是 $ (W) $ 的解。

对于任意 $ v \in \mathcal{V} $，要证 $ J(u) \leq J(v) $。

令 $ w = v - u $，则 $ v = u + w $。注意 $ w \in \mathcal{V} $。

$$
J(v) = J(u + w) = \frac{1}{2}(u + w, u + w) - (f, u + w)
$$

$$
= \frac{1}{2}(u, u) + \frac{1}{2}(w, w) + (u, w) - (f, u) - (f, w)
$$

$$
= \frac{1}{2}(u, u) + \frac{1}{2}(w, w) + (u, w) - (f, u) - (f, w)
$$

因为 $ u $ 是 $ (W) $ 的解，且 $ w \in \mathcal{V} $，由定义知

$$
(u', w') - (f, w) = 0
$$

故

$$
J(v) = \frac{1}{2}(u, u) + \frac{1}{2}(w, w) \geq J(u)
$$

因此，$ J(u) \leq J(v) $，即证明了 $ (W) \Rightarrow (M) $。

#### $ (M) \Rightarrow (W) $

对于任意 $ v \in \mathcal{V} $，设 $ u + \varepsilon v \in \mathcal{V} $。

$$
J(u) \leq J(u + \varepsilon v)
$$

令 $ g(\varepsilon) = J(u + \varepsilon v) $

$$
= \frac{1}{2}(u + \varepsilon v, u + \varepsilon v) - (f, u + \varepsilon v)
$$

$$
= \frac{1}{2}(u, u) + \varepsilon(u, v) + \frac{\varepsilon^2}{2}(v, v) - (f, u) - \varepsilon(f, v)
$$

由于 $ g(\varepsilon) $ 在 $ \varepsilon = 0 $ 时取极小值，故有 $ g'(0) = 0 $。

$$
g'(0) = (u, v) - (f, v) = 0
$$

因此

$$
(u', v') - (f, v) = 0
$$

即证明了 $ (M) \Rightarrow (W) $。

---

这段笔记主要证明了变分问题 $ (W) $ 与极小化问题 $ (M) $ 的等价性，分为两个方向进行证明：

1. $ (W) \Rightarrow (M) $：假设 $ u $ 是变分问题的解，利用定义证明 $ u $ 也是极小化问题的解；
2. $ (M) \Rightarrow (W) $：假设 $ u $ 是极小化问题的解，利用 $ g(\varepsilon) $ 作为辅助函数，通过导数证明 $ u $ 满足变分问题的条件。

### $ (W) \Rightarrow (P) $

设 $ u \in \mathcal{V} $ 是变分问题 $ (W) $ 的解，且 $ u'' $ 连续，边界条件 $ v(0) = v(1) = 0 $。

$$
a(u, v) = \left\langle f, v \right\rangle, \quad \forall v \in \mathcal{V}
$$

即

$$
0 = \int_0^1 u' v' \, dx - \int_0^1 f v \, dx
$$

$$
= -\int_0^1 u'' v \, dx + \left[ u'(1)v(1) - u'(0)v(0) \right] - \int_0^1 f v \, dx
$$

由于边界条件 $ v(0) = v(1) = 0 $，上述表达式化简为：

$$
= -\int_0^1 u'' v \, dx - \int_0^1 f v \, dx
$$

因此

$$
-\int_0^1 u'' v \, dx = \int_0^1 f v \, dx, \quad \forall v \in \mathcal{V}
$$

这表明：

$$
u'' = f
$$

#### 变分问题解的唯一性

假设 $ u_1, u_2 $ 是 $ (W) $ 问题的解，且 $ u_1, u_2 \in \mathcal{V} $。

$$
\begin{cases}
a(u_1, v) = \left\langle f, v \right\rangle, \quad \forall v \in \mathcal{V} \\
a(u_2, v) = \left\langle f, v \right\rangle, \quad \forall v \in \mathcal{V}
\end{cases}
$$

因此：

$$
a(u_1 - u_2, v) = 0, \quad \forall v \in \mathcal{V}
$$

取 $ v = u_1 - u_2 $，则：

$$
a(u_1 - u_2, u_1 - u_2) = 0
$$

$$
\int_0^1 (u_1' - u_2')^2 \, dx = 0 \quad \Rightarrow \quad u_1' - u_2' = 0, \quad \forall x \in (0, 1)
$$

故 $ u_1 - u_2 $ 为常数。又因边界条件 $ u_1(0) = u_2(0) $，故 $ u_1 = u_2 $。

---

这段笔记主要证明了变分问题 $ (W) $ 的解与对应的偏微分方程 $ (P) $ 的等价性，同时也证明了变分问题解的唯一性。


首先，我会处理第一张图片中的内容：

### 笔记内容（2021-09-07）

#### 弱解空间的解的唯一性

设 $\Omega$ 为定义区域，设 $u_1, u_2$ 为解，$v \in V$，则：

$$
a(u_1 - u_2, v) = 0
$$

即：

$$
a(u_1, v) - a(u_2, v) = 0
$$

再根据 $v = u_1 - u_2 \in V$，可以得出：

$$
a(u_1 - u_2, u_1 - u_2) = 0
$$

因此 $u_1 - u_2 = 0$，则 $u_1 = u_2$，所以解的唯一性得证。

#### 有限元方法的基本思想

1. **将高阶、偏微分问题转化为变分问题（相对的低阶问题）。**
2. **用有限维逼近空间 $V_h \subset V$, $V_h \subset C^0$。**
3. **利用有限元法逼近复杂边界问题。**

#### Step-by-step 求解过程

1. 划分区域：
   把区域 $\Omega$ 分成有限单元：设 $x_1, x_2, \dots, x_{N+1}$，定义 $h = \max h_i$。
   
2. 定义分段线性函数构造有限维空间 $V_h$。

3. 求解：
   - 对所有 $V_h \subset C^0$，有：
   
     $$
     a(u_h, v_h) = \int_{\Omega} f v_h \quad \forall v_h \in V_h
     $$

4. 利用基函数逼近解：
   - 设 $u_h = \sum_{j=1}^{N} U_j \phi_j(x)$，从而有：

     $$
     a(u_h, v_h) = \sum_{i,j} A_{ij} U_j
     $$

---
接下来是第二张图片中的内容整理：

### 笔记内容（继续）

我们定义有限维空间 $V_h$ 为由基函数 $\phi_1, \phi_2, \dots, \phi_N$ 张成的空间：

$$
V_h = \text{span} \{\phi_1, \phi_2, \dots, \phi_N\}
$$

则 $u_h \in V_h$ 可以表示为：

$$
u_h(x) = \sum_{i=1}^{N} U_i \phi_i(x)
$$

#### 双线性形式 $a(u_h, v_h)$ 的计算

对于所有 $u_h, v_h \in V_h$，设 $u_h(x) = \sum_{i=1}^{N} U_i \phi_i(x)$，且 $v_h(x) = \sum_{j=1}^{N} V_j \phi_j(x)$，双线性形式 $a(u_h, v_h)$ 定义为：

$$
a(u_h, v_h) = \sum_{i=1}^{N} \sum_{j=1}^{N} U_i V_j a(\phi_i, \phi_j)
$$

其中 $a(\phi_i, \phi_j)$ 为双线性形式在基函数上的值，可通过积分得到：

$$
a(\phi_i, \phi_j) = \int_{\Omega} \nabla \phi_i \cdot \nabla \phi_j \, dx
$$

#### 组装刚度矩阵 $A$

为了求解有限元方程，需要组装刚度矩阵 $A$，其元素为：

$$
A_{ij} = a(\phi_i, \phi_j) = \int_{\Omega} \nabla \phi_i \cdot \nabla \phi_j \, dx
$$

通过对每个单元进行积分，我们可以得到 $A_{ij}$ 的具体值。

---

#### 具体求解过程

对每个有限单元，我们通过定义基函数 $\phi_i$ 和 $\phi_j$，计算双线性形式 $a(\phi_i, \phi_j)$：

$$
A_{ij} = \int_{x_{i-1}}^{x_i} \frac{1}{h_i} dx + \int_{x_i}^{x_{i+1}} \frac{1}{h_{i+1}} dx
$$

这样，对于每个 $i$ 和 $j$，我们都可以得到 $A_{ij}$ 的表达式。并且，矩阵 $A$ 的结构通常是稀疏的，具体形式如下：

$$
A =
\begin{pmatrix}
\frac{1}{h_1} + \frac{1}{h_2} & -\frac{1}{h_2} & 0 & \dots & 0 \\
-\frac{1}{h_2} & \frac{1}{h_2} + \frac{1}{h_3} & -\frac{1}{h_3} & \dots & 0 \\
0 & -\frac{1}{h_3} & \ddots & \ddots & \vdots \\
\vdots & & \ddots & & -\frac{1}{h_N} \\
0 & \dots & & -\frac{1}{h_N} & \frac{1}{h_N}
\end{pmatrix}
$$

---

最后，有限元方法的离散化问题可以表示为求解矩阵方程：

$$
A \mathbf{U} = \mathbf{F}
$$

其中，$\mathbf{U} = (U_1, U_2, \dots, U_N)^T$ 是待求的系数向量，$\mathbf{F}$ 是右端项通过同样的方法离散化得到的向量。

---

接下来我将处理最后一张图片中的内容。

这是第三张图片中的内容整理：

### 笔记内容（继续）

对于任意 $u_h, v_h \in V_h$，可以将弱形式写为以下方程：

$$
a(u_h, v_h) = \int_{\Omega} \nabla u_h \cdot \nabla v_h \, dx = \sum_{i=1}^{N} \sum_{j=1}^{N} U_i V_j a(\phi_i, \phi_j)
$$

其中，$a(\phi_i, \phi_j)$ 表示基函数的双线性形式。

### 刚度矩阵 $A$ 的构造

刚度矩阵 $A$ 的元素 $A_{ij}$ 定义为：

$$
A_{ij} = a(\phi_i, \phi_j) = \int_{x_{i-1}}^{x_i} \frac{1}{h_i} dx + \int_{x_i}^{x_{i+1}} \frac{1}{h_{i+1}} dx
$$

根据积分的计算，刚度矩阵 $A$ 的具体形式可以写为：

$$
A = 
\begin{pmatrix}
\frac{1}{h_1} + \frac{1}{h_2} & -\frac{1}{h_2} & 0 & \dots & 0 \\
-\frac{1}{h_2} & \frac{1}{h_2} + \frac{1}{h_3} & -\frac{1}{h_3} & \dots & 0 \\
0 & -\frac{1}{h_3} & \ddots & \ddots & \vdots \\
\vdots & & \ddots & & -\frac{1}{h_N} \\
0 & \dots & & -\frac{1}{h_N} & \frac{1}{h_N}
\end{pmatrix}
$$

#### 边界条件的处理

在处理边界问题时，特别是在有限元方法中，需要根据边界条件对刚度矩阵和右端项进行修正。例如，当施加Dirichlet边界条件时，$u_h(x)$ 在边界点的值被固定。

边界条件会影响矩阵方程 $A \mathbf{U} = \mathbf{F}$ 的解法。例如，考虑Dirichlet边界条件 $u(0) = u(1) = 0$，我们需要对相应的矩阵 $A$ 进行修改。

### 方程的最终形式

通过构造刚度矩阵 $A$ 和右端向量 $\mathbf{F}$，我们可以得到一个线性方程组：

$$
A \mathbf{U} = \mathbf{F}
$$

其中，$\mathbf{U} = (U_1, U_2, \dots, U_N)^T$ 是未知的系数向量，表示解的近似值，$\mathbf{F}$ 是通过对右端项进行离散化得到的向量。

---

以上就是三张图片内容的整理和公式表示。如果需要进一步调整或有其他要求，请告诉我！
